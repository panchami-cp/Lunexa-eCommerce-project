<%- include("../partials/user/header")%>

<head>
  <link rel="stylesheet" href="/css/user/signup.css">
</head>

<section class="auth-wrapper">
  <div class="auth-card login-card">
    <div class="auth-header">LOGIN</div>

    <form action="/login" method="POST" class="auth-form" id="login_form">

      <div class="auth-field">
        <input type="email" placeholder="Email" class="auth-input" id="email" name="email">
        <div class="invalid-feedback" id="email_error"></div>
      </div>

      <div class="auth-field">
        <input type="password" placeholder="Password" class="auth-password" id="password" name="password">
        <i class='bx bx-hide toggle-visibility'></i>
        <div class="invalid-feedback" id="password_error"></div>
      </div>

      <div class="auth-actions">
        <a href="/verify_email" class="reset-password" style="font-size: 1rem;">Forgot password?</a>
      </div>

      <% if (locals.message && message.length > 0) { %>
        <div style="color: rgb(206, 5, 5)"><%= message %></div>
      <% } %>

      <div class="auth-button-group">
        <button type="submit" class="auth-submit" style="background-color: black;">LOGIN</button>
      </div>

    </form>

    <div class="auth-footer center-align">
      <span>Don't have an account? <a href="/signup" class="switch-auth switch-to-signup">Signup</a></span>
    </div>

    <div class="separator"></div>

    <div class="social-login">
      <a href="/auth/google" class="social-button google-button">
        <img src="https://cdn1.iconfinder.com/data/icons/google-s-logo/150/Google_Icons-09-512.png" alt="Google Logo" class="google-icon">
        <span>Signin with Google</span>
      </a>
    </div>
  </div>
</section>

<script>
  const email = document.getElementById('email');
  const password = document.getElementById('password');
  const emailError = document.getElementById('email_error');
  const passwordError = document.getElementById('password_error');

  function setInvalid(field, errorDiv, message) {
    field.classList.add('is-invalid');
    errorDiv.style.display = 'block';
    errorDiv.innerText = message;
  }

  function clearInvalid(field, errorDiv) {
    field.classList.remove('is-invalid');
    errorDiv.style.display = 'none';
    errorDiv.innerText = '';
  }

  function emailValidation() {
    const emailValue = email.value.trim();
    const emailPattern = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;

    if (!emailValue) {
      setInvalid(email, emailError, 'This field is required');
    } else if (!emailPattern.test(emailValue)) {
      setInvalid(email, emailError, 'Enter a valid email ID');
    } else {
      clearInvalid(email, emailError);
    }
  }

  function passwordValidation() {
    const passwordValue = password.value.trim();

    if (!passwordValue) {
      setInvalid(password, passwordError, 'This field is required');
    } else {
      clearInvalid(password, passwordError);
    }
  }

  document.addEventListener("DOMContentLoaded", function () {
    document.getElementById("login_form").addEventListener("submit", function (event) {
      emailValidation();
      passwordValidation();

      if (
        emailError.innerText ||
        passwordError.innerText
      ) {
        event.preventDefault();
      }
    });
  });
</script>

<!-- footer -->
<%- include("../partials/user/footer")%>
<script src="js/jquery.min.js"></script>
<script src="js/plugins.js"></script>
<script src="js/SmoothScroll.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/js/bootstrap.bundle.min.js"
  integrity="sha384-ENjdO4Dr2bkBIFxQpeoTz1HIcje39Wm4jDKdf19U8gI4ddQ3GYNS7NTKfAdVQSZe"
  crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/swiper@9/swiper-bundle.min.js"></script>
<script src="js/script.min.js"></script>
</body>
</html>
