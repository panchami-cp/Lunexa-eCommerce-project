<%- include("../partials/user/header") %>

  <head>
    <link rel="stylesheet" href="/css/user/orders.css">
  </head>

  <div class="container-fluid">

    <div class="d-flex justify-content-evenly align-items-center mb-4 mt-4">

      <h4 class="mb-0">Orders</h4>

      <form class="d-flex" action="/orders" method="get">
        <div class="search-wrapper">
          <input type="text" name="searchInput" class="form-control" placeholder="Search orders..." id="searchInput">
          <button type="button" class="clear-btn" id="clearSearch">&times;</button>
        </div>
        <button type="submit" class="btn btn-primary ms-2">Search</button>
      </form>

    </div>

    <% orders.forEach(order=> { %>
      <div class="orders-container">

        <div class="order-box">
          <!-- Order ID -->
          <div class="order-id">Order ID: <%= order.orderId %>
          </div>

          <div class="order-content">
            <!-- Left: Product Info (vertical list) -->
            <div class="products-list " style="width: 100%;">
              <% order.items.forEach(item=> { %>
                <div class="d-flex justify-content-between" style="width: 100%;">
                  <div class="product-info mt-3">
                    <img src="/uploads/re-product-image/<%= item.productId.productImage[0] %>"
                      alt="<%= item.productId.productName %>" class="product-image">
                    <div class="product-details">
                      <h5 class="text-capitalize">
                        <%= item.productId.productName %>
                          <% if(item.orderStatus==='Cancelled' ){ %>
                            <span class="text-secondary">(Cancelled)</span>
                            <% } else if(item.returnRequest && item.returnRequest.status==='Pending' ){ %>
                              <span class="text-warning">(Return Pending)</span>
                              <% } else if(item.returnRequest && item.returnRequest.status==='Approved' ){ %>
                                <span class="text-success">(Return Approved)</span>
                                <% } else if(item.returnRequest && item.returnRequest.status==='Rejected' ){ %>
                                  <span class="text-danger">(Return Rejected)</span>
                                  <% } else if(item.returnRequest && item.returnRequest.status==='Refunded' ){ %>
                                    <span class="text-success">(Refunded)</span>
                                    <% } %>

                      </h5>
                      <p>Size: <%= item.size %></p>
                      <p>Price: â‚¹<%= item.price %></p>
                      <%if(item.deliveryDate){%>
                      <p>Delivery Date: <%=new Date(item.deliveryDate).toLocaleDateString("en-GB")%></p>
                      <%}else{%>
                        <P></P>
                        <%}%>
                    </div>
                  </div>
                  <div class="order-action">
                    <a href="/order_details?id=<%=item._id%>" class="btn btn-outline-secondary">View</a>
                  </div>
                </div>
                <% }) %>
            </div>
          </div>
        </div>

      </div>
      <% }) %>
  </div>

  <!-- Footer -->
  <%- include("../partials/user/footer") %>

    <script src="js/jquery.min.js"></script>
    <script src="js/plugins.js"></script>
    <script src="js/SmoothScroll.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-ENjdO4Dr2bkBIFxQpeoTz1HIcje39Wm4jDKdf19U8gI4ddQ3GYNS7NTKfAdVQSZe"
      crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/swiper@9/swiper-bundle.min.js"></script>
    <script src="js/script.min.js"></script>

    </body>

    </html>