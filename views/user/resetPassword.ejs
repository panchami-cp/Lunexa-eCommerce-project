
<%- include("../partials/user/header")%>

<head>
    <link rel="stylesheet" href="/css/user/signup.css">
</head>

<section class="auth-wrapper">
    <div class="auth-card login-card">
        <div class="auth-header">LOGIN</div>

        <!-- form -->
        <form action="/reset_password" method="POST" class="auth-form" id="login_form">
            <!-- Password -->
            <div class="auth-field">
                <input type="password" placeholder="Enter new password" class="auth-input form-control" id="password" name="password">
                <div class="invalid-feedback" id="password_error"></div>
            </div>

            <!-- Confirm Password -->
            <div class="auth-field">
                <input type="password" placeholder="Confirm password" class="auth-input form-control" id="confirmPassword" name="confirmPassword">
                <div class="invalid-feedback" id="confirm_password_error"></div>
            </div>

            <% if (locals.message && message.length > 0) { %>
                <div style="color: rgb(206, 5, 5);"><%= message %></div>
            <% } %>

            <div class="auth-button-group">
                <button type="submit" class="auth-submit" style="background-color: black;">RESET PASSWORD</button>
            </div>
        </form>

        <div class="auth-footer center-align">
            <span>Don't have an account? <a href="/signup" class="switch-auth switch-to-signup">Signup</a></span>
        </div>
    </div>
</section>

<script>
    const password = document.getElementById('password');
    const confirmPassword = document.getElementById('confirmPassword');
    const passwordError = document.getElementById('password_error');
    const confirmPasswordError = document.getElementById('confirm_password_error');

    function passwordValidation() {
        const passwordValue = password.value;
        const pattern = /^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)(?=.*[^A-Za-z\d])[A-Za-z\d\S]{8,}$/;

        if (passwordValue === "") {
            password.classList.add("is-invalid");
            passwordError.textContent = "This field is required";
        } else if (passwordValue.length < 8) {
            password.classList.add("is-invalid");
            passwordError.textContent = "Password must be at least 8 characters long";
        } else if (!pattern.test(passwordValue)) {
            password.classList.add("is-invalid");
            passwordError.textContent = "Password must include uppercase, lowercase, number, and special character";
        } else {
            password.classList.remove("is-invalid");
            passwordError.textContent = "";
        }
    }

    function confirmPasswordValidation() {
        const cPasswordValue = confirmPassword.value;

        if (cPasswordValue === "") {
            confirmPassword.classList.add("is-invalid");
            confirmPasswordError.textContent = "This field is required";
        } else if (cPasswordValue !== password.value) {
            confirmPassword.classList.add("is-invalid");
            confirmPasswordError.textContent = "Passwords do not match";
        } else {
            confirmPassword.classList.remove("is-invalid");
            confirmPasswordError.textContent = "";
        }
    }

    document.addEventListener("DOMContentLoaded", function () {
        document.getElementById("login_form").addEventListener("submit", function (event) {
            passwordValidation();
            confirmPasswordValidation();

            if (password.classList.contains("is-invalid") || confirmPassword.classList.contains("is-invalid")) {
                event.preventDefault();
            }
        });
    });
</script>

<!-- footer -->
<%- include("../partials/user/footer")%>
   <script src="js/jquery.min.js"></script>
   <script src="js/plugins.js"></script>
   <script src="js/SmoothScroll.js"></script>
   <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
   <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/js/bootstrap.bundle.min.js"
     integrity="sha384-ENjdO4Dr2bkBIFxQpeoTz1HIcje39Wm4jDKdf19U8gI4ddQ3GYNS7NTKfAdVQSZe"
     crossorigin="anonymous"></script>
   <script src="https://cdn.jsdelivr.net/npm/swiper@9/swiper-bundle.min.js"></script>
   <script src="js/script.min.js"></script>
 </body>
 
 </html>